# Default target skeleton stuff, may be overridden
EXTRAVERSION=
TARGET_SKELETON=target/default/skel.tar.gz
TARGET_SKEL_DIR=target/default/target_skeleton

include target/device/Makefile.in

ifeq ($(strip $(BR2_TARGET_ROOTFS_JFFS2)),y)
include target/jffs2/blocksize.mk
JFFS2FLAGS+=-a $(JFFS2_BLOCK_SIZE) 
endif


openwrt-linux.trx: openwrt-trx
	PATH=$(TARGET_PATH) trx -o openwrt-linux$(EXTRAVERSION).trx \
	 $(LINUX_DIR)/$(LINUX_BINLOC) $(JFFS2FLAGS) $(IMAGE).$(ROOTFS)

openwrt-gs-code.bin: openwrt-addpattern openwrt-linux.trx
	PATH=$(TARGET_PATH) addpattern -2 -i  openwrt-linux$(EXTRAVERSION).trx \
	-o openwrt-gs-code$(EXTRAVERSION).bin -g

openwrt-g-code.bin: openwrt-gs-code.bin
	sed -e "1s,^W54S,W54G," < openwrt-gs-code$(EXTRAVERSION).bin > openwrt-g-code$(EXTRAVERSION).bin

openwrt-image:	openwrt openwrt-g-code.bin

openwrt-image-clean: 
	@-rm openwrt-* 2>/dev/null

openwrt-image-dirclean: openwrt-dirclean
