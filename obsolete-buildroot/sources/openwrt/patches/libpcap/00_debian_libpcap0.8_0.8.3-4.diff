--- libpcap0.8-0.8.3.orig/debian/compat
+++ libpcap0.8-0.8.3/debian/compat
@@ -0,0 +1,2 @@
+4
+
--- libpcap0.8-0.8.3.orig/debian/copyright
+++ libpcap0.8-0.8.3/debian/copyright
@@ -0,0 +1,115 @@
+This package was debianized by Romain Francoise <rfrancoise@debian.org>
+on Fri, 16 Apr 2004 18:41:39 +0200, based on work by:
+ + Anand Kumria <wildfire@progsoc.org>
+ + Torsten Landschoff <torsten@debian.org>
+
+It was downloaded from http://tcpdump.org/release/libpcap-0.8.3.tar.gz
+
+Upstream Authors: tcpdump-workers@tcpdump.org
+
+Licensed under the 3-clause BSD license: 
+
+  Redistribution and use in source and binary forms, with or without
+  modification, are permitted provided that the following conditions
+  are met:
+
+    1. Redistributions of source code must retain the above copyright
+       notice, this list of conditions and the following disclaimer.
+    2. Redistributions in binary form must reproduce the above copyright
+       notice, this list of conditions and the following disclaimer in
+       the documentation and/or other materials provided with the
+       distribution.
+    3. The names of the authors may not be used to endorse or promote
+       products derived from this software without specific prior
+       written permission.
+
+  THIS SOFTWARE IS PROVIDED ``AS IS'' AND WITHOUT ANY EXPRESS OR
+  IMPLIED WARRANTIES, INCLUDING, WITHOUT LIMITATION, THE IMPLIED
+  WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.
+
+Current upstream maintainers:
+	Bill Fenner			<fenner@research.att.com>
+	Fulvio Risso			<risso@polito.it>
+	Guy Harris	 		<guy@alum.mit.edu>
+	Hannes Gredler			<hannes@juniper.net>
+	Jun-ichiro itojun Hagino	<itojun@iijlab.net>
+	Michael Richardson	 	<mcr@sandelman.ottawa.on.ca>
+
+Additional people who have contributed patches:
+
+	Alan Bawden			<Alan@LCS.MIT.EDU>
+	Alexey Kuznetsov		<kuznet@ms2.inr.ac.ru>
+	Albert Chin			<china@thewrittenword.com>
+	Andrew Brown			<atatat@atatdot.net>
+	Antti Kantee			<pooka@netbsd.org>
+	Arkadiusz Miskiewicz		<misiek@pld.org.pl>
+	Armando L. Caro Jr.		<acaro@mail.eecis.udel.edu>
+	Assar Westerlund	 	<assar@sics.se>
+	Brian Ginsbach			<ginsbach@cray.com>
+	Charles M. Hannum		<mycroft@netbsd.org>
+	Chris G. Demetriou		<cgd@netbsd.org>
+	Chris Pepper			<pepper@mail.reppep.com>
+	Darren Reed			<darrenr@reed.wattle.id.au>
+	David Kaelbling			<drk@sgi.com>
+	David Young			<dyoung@ojctech.com>
+	Don Ebright			<Don.Ebright@compuware.com> 
+	Eric Anderson			<anderse@hpl.hp.com>
+	Franz Schaefer			<schaefer@mond.at>
+	Gianluca Varenni		<varenni@netgroup-serv.polito.it>
+	Gisle Vanem			<giva@bgnett.no>
+	Graeme Hewson			<ghewson@cix.compulink.co.uk>
+	Greg Stark			<gsstark@mit.edu>
+	Greg Troxel			<gdt@ir.bbn.com>
+	Guillaume Pelat			<endymion_@users.sourceforge.net>
+	Hyung Sik Yoon			<hsyn@kr.ibm.com>
+	Igor Khristophorov		<igor@atdot.org>
+	Jan-Philip Velders		<jpv@veldersjes.net>
+	Jason R. Thorpe			<thorpej@netbsd.org>
+	Javier Achirica			<achirica@ttd.net>
+	Jean Tourrilhes			<jt@hpl.hp.com>
+	Jefferson Ogata			<jogata@nodc.noaa.gov>
+	Jesper Peterson			<jesper@endace.com>
+	John Bankier			<jbankier@rainfinity.com>
+	Jon Lindgren			<jonl@yubyub.net>
+	Juergen Schoenwaelder		<schoenw@ibr.cs.tu-bs.de>
+	Kazushi Sugyo			<sugyo@pb.jp.nec.com>
+	Klaus Klein			<kleink@netbsd.org>
+	Koryn Grant			<koryn@endace.com>
+	Krzysztof Halasa		<khc@pm.waw.pl>
+	Lorenzo Cavallaro		<sullivan@sikurezza.org>
+	Loris Degioanni			<loris@netgroup-serv.polito.it>
+	Love Hörnquist-Åstrand		<lha@stacken.kth.se>
+	Maciej W. Rozycki		<macro@ds2.pg.gda.pl>
+	Marcus Felipe Pereira		<marcus@task.com.br>
+	Martin Husemann			<martin@netbsd.org>
+	Mike Wiacek			<mike@iroot.net>
+	Monroe Williams			<monroe@pobox.com>
+	Octavian Cerna			<tavy@ylabs.com>
+	Olaf Kirch			<okir@caldera.de>
+	Onno van der Linden		<onno@simplex.nl>
+	Paul Mundt			<lethal@linux-sh.org>
+	Pavel Kankovsky			<kan@dcit.cz>
+	Peter Fales			<peter@fales-lorenz.net>
+	Peter Jeremy			<peter.jeremy@alcatel.com.au>
+	Phil Wood			<cpw@lanl.gov>
+	Rafal Maszkowski		<rzm@icm.edu.pl>
+	Rick Jones			<raj@cup.hp.com>
+	Scott Barron			<sb125499@ohiou.edu>
+	Scott Gifford			<sgifford@tir.com>
+	Sebastian Krahmer		<krahmer@cs.uni-potsdam.de>
+	Shaun Clowes			<delius@progsoc.uts.edu.au>
+	Solomon Peachy			<pizza@shaftnet.org>
+	Stefan Hudson			<hudson@mbay.net>
+	Takashi Yamamoto		<yamt@mwd.biglobe.ne.jp>
+	Tony Li				<tli@procket.com>
+	Torsten Landschoff	 	<torsten@debian.org>
+	Uns Lider			<unslider@miranda.org>
+	Uwe Girlich			<Uwe.Girlich@philosys.de>
+	Xianjie Zhang			<xzhang@cup.hp.com>
+	Yen Yen Lim
+	Yoann Vandoorselaere		<yoann@prelude-ids.org>
+
+The original LBL crew:
+	Steve McCanne
+	Craig Leres
+	Van Jacobson
--- libpcap0.8-0.8.3.orig/debian/control
+++ libpcap0.8-0.8.3/debian/control
@@ -0,0 +1,44 @@
+Source: libpcap0.8
+Section: devel
+Priority: optional
+Maintainer: Romain Francoise <rfrancoise@debian.org>
+Uploaders: Torsten Landschoff <torsten@debian.org>
+Build-Depends: debhelper (>= 4), flex, bison, dpatch, perl
+Standards-Version: 3.6.1.0
+
+Package: libpcap0.8-dev
+Section: libdevel
+Architecture: any
+Depends: libpcap0.8 (= ${Source-Version}), libc6-dev
+Conflicts: libpcap-dev, libpcap0.7-dev
+Description: Development library and header files for libpcap 0.8
+ Headers, static libraries, and documentation for the libpcap library.
+ .
+ libpcap (Packet CAPture) provides a portable framework for low-level
+ network monitoring.  Applications include network statistics
+ collection, security monitoring, network debugging, etc.
+ .
+ Since almost every system vendor provides a different interface for 
+ packet capture, and since there are several tools that require this 
+ functionality, we've created this system-independent API to ease in 
+ porting and to alleviate the need for several system-dependent packet 
+ capture modules in each application.
+ .
+ Further information is available at <URL: http://www.tcpdump.org/>
+
+Package: libpcap0.8
+Section: libs
+Architecture: any
+Depends: ${shlibs:Depends}
+Description: System interface for user-level packet capture
+ libpcap (Packet CAPture) provides a portable framework for low-level 
+ network monitoring.  Applications include network statistics collection, 
+ security monitoring, network debugging, etc.  
+ .
+ Since almost every system vendor provides a different interface for 
+ packet capture, and since there are several tools that require this 
+ functionality, we've created this system-independent API to ease in 
+ porting and to alleviate the need for several system-dependent packet 
+ capture modules in each application.
+ .
+ Further information is available at <URL: http://www.tcpdump.org/>
--- libpcap0.8-0.8.3.orig/debian/changelog
+++ libpcap0.8-0.8.3/debian/changelog
@@ -0,0 +1,236 @@
+libpcap0.8 (0.8.3-4) unstable; urgency=low
+
+  * debian/patches/30_man_fixes.dpatch: Explicitly mention `pcap_handler'
+    as routine type for pcap_loop() and pcap_dispatch() callbacks,
+    suggested by Florian Weimer <fw@deneb.enyo.de> (closes: #255267).
+
+ -- Romain Francoise <rfrancoise@debian.org>  Wed, 21 Jul 2004 19:46:07 +0200
+
+libpcap0.8 (0.8.3-3) unstable; urgency=low
+
+  * debian/control: libpcap0.8-dev conflicts with libpcap0.7-dev.
+
+ -- Romain Francoise <rfrancoise@debian.org>  Wed,  9 Jun 2004 11:44:50 +0200
+
+libpcap0.8 (0.8.3-2) unstable; urgency=low
+
+  * debian/control:
+    + Put back URL markers in description.
+    + Switch Maintainer and Uploaders fields to match reality.
+  * debian/patches/30_man_fixes.dpatch: Patch to fix some inconsistencies 
+    in the upstream man page (tcpdump is in section 8, not 1).
+  * debian/patches/00list: Add 30_man_fixes.
+
+ -- Romain Francoise <rfrancoise@debian.org>  Fri, 14 May 2004 23:43:02 +0200
+
+libpcap0.8 (0.8.3-1) unstable; urgency=low
+
+  * New upstream release (closes: #235155).
+    + bpf_filter.c now has config.h (closes: #171210).
+    + Does not ship CVS directories anymore (closes: #119750).
+    + Has improved "truncated file" messages (closes: #207535).
+  * New source package to ease the 0.7 -> 0.8 transition, each source
+    package builds corresponding libpcap0.x{,-dev} binary packages.  The
+    libpcap-dev package is provided by libpcap0.7 for now.
+  * debian/copyright: Rewrite.  Licensing information is now complete in
+    the upstream tarball.
+  * debian/control: 
+    + Update source and binary package names.
+    + Build-Depend on dpatch, perl.
+    + Bump Standards-Version to 3.6.1.0.
+  * debian/rules:
+    + Clean up CFLAGS handling.
+    + Support DEB_BUILD_OPTIONS.
+    + Use dpatch for patch management.
+    + Compute major/minor versions from the changelog instead of
+      hardcoding them.
+  * debian/patches: New directory.
+  * debian/patches/10_shared_lib.dpatch: Patch split off the Debian diff 
+    to build a shared library (upstream does not support it).
+  * debian/patches/20_mac_syntax.dpatch: Patch split off the Debian diff 
+    to support more MAC address syntaxes (by Torsten Landschoff).
+  * debian/patches/00list: New file (patch list).
+
+ -- Romain Francoise <rfrancoise@debian.org>  Fri, 30 Apr 2004 16:14:10 +0200
+
+libpcap (0.7.2-5) unstable; urgency=low
+
+  * debian/rules: Update version variables, this is version 0.7.2.
+  * Makefile.in: Fix version.
+
+ -- Romain Francoise <rfrancoise@debian.org>  Tue, 11 Nov 2003 12:14:28 +0100
+
+libpcap (0.7.2-4) unstable; urgency=low
+
+  * debian/libpcap-dev.preinst: New file.  Remove old symlink from
+    /usr/share/doc/libpcap-dev to libpcap0 since we now have a real
+    libpcap-dev directory.  Closes: #175742.
+  * debian/rules: Add -A flag to dh_installdocs so that it acts on all
+    binary packages.
+
+ -- Romain Francoise <rfrancoise@debian.org>  Mon, 20 Oct 2003 18:49:22 +0200
+
+libpcap (0.7.2-3) unstable; urgency=low
+
+  * debian/control: libpcap-dev is in section libdevel, not in section
+    devel.
+
+ -- Romain Francoise <rfrancoise@debian.org>  Sun, 19 Oct 2003 19:22:12 +0200
+
+libpcap (0.7.2-2) unstable; urgency=low
+
+  * debian/control: 
+    + Adding myself as co-maintainer, with Torsten's blessing.
+    + Repeat extended description in libpcap-dev description
+      (closes: #209728)
+    + Remove Emacs-style <URL: ...> markers from the descriptions.
+      (closes: #196727).
+    + Remove full stops from synopsis as per Policy.
+    + Add versioned build-dependency on debhelper (>= 4).
+  * debian/copyright: Remove dh-make boilerplates.
+  * debian/compat: New file.
+  * debian/rules: Remove obsolete DH_COMPAT variable.
+
+ -- Romain Francoise <rfrancoise@debian.org>  Sun, 19 Oct 2003 18:17:41 +0200
+
+libpcap (0.7.2-1) unstable; urgency=low
+
+  * New upstream release.
+
+ -- Torsten Landschoff <torsten@debian.org>  Sat,  7 Jun 2003 22:57:55 +0200
+
+libpcap (0.7.1-1) unstable; urgency=low
+
+  * New upstream release (closes: #145538).
+  * debian/rules: Build the library with _FILE_OFFSET_BITS set to 64
+    to allow for files bigger than 2GB (closes: #129213).
+  * Rename the library package to libpcap0.7 and change the SONAME so that we
+    can account for interface changes (closes: #132359).
+  * Run ldconfig as appropriate (lintian).
+  * Remove watch.ex template and the silly symlink from libpcap-dev's 
+    documentation to libpcap0 (lintian).
+
+ -- Torsten Landschoff <torsten@debian.org>  Sat,  3 Aug 2002 23:33:56 +0200
+
+libpcap (0.6.2-2) unstable; urgency=low
+
+  * debian/control: Change section of libpcap0 from net to libs
+    (Debian installer message).
+  * aclocal.m4: Treat the ia64 as a cpu which can't handle unaligned 
+    memory access (closes: #112152). Thanks for the report go to 
+    John R. Daily.
+
+ -- Torsten Landschoff <torsten@debian.org>  Fri, 14 Sep 2001 10:15:52 +0200
+
+libpcap (0.6.2-1) unstable; urgency=medium
+
+  * New upstream release.
+  * debian/control: Removed Build-Depends already satisfied by the
+    build-essential package.
+  * gencode.c (gen_scode): Add the missing default branch of the protocol
+    family switch (closes: 88688).
+  * debian/libpcap.post{rm,inst}: Run ldconfig (lintian).
+  * debian/copyright: Fix the "similiar" typo (lintian).
+
+ -- Torsten Landschoff <torsten@debian.org>  Tue,  6 Mar 2001 04:27:27 +0100
+
+libpcap (0.6.1-2) unstable; urgency=low
+
+  * debian/rules: Changed the shlibs info so that only pcap 0.6
+    is okay for packages linked against this version.
+
+ -- Torsten Landschoff <torsten@debian.org>  Thu, 18 Jan 2001 01:13:20 +0100
+
+libpcap (0.6.1-1) unstable; urgency=low
+
+  * Taking back the package. Kudos to Anand for helping out.
+  * debian/rules: Pass --enable-ipv6 to configure (closes: #80223).
+
+ -- Torsten Landschoff <torsten@debian.org>  Tue, 16 Jan 2001 15:40:37 +0100
+
+libpcap (0.5.2-2) unstable; urgency=low
+
+  * Update config.guess and config.sub (Closes #26031)
+  * Source builds would not always work. Fix that.
+  * Kernel interface problem is really a module not loaded problem. 
+    Note this in README.Debian. (Closes #21356)
+
+ -- Anand Kumria <wildfire@progsoc.org>  Tue, 28 Nov 2000 02:03:25 +1100
+
+libpcap (0.5.2-1) unstable; urgency=low
+
+  * New upstream release
+  * New maintainer
+  * Migrate to Debhelper and insert Build-Depends
+
+ -- Anand Kumria <wildfire@progsoc.org>  Sun, 12 Nov 2000 03:19:44 +1100
+
+libpcap (0.4a6-3) unstable; urgency=low
+
+  * New maintainer.
+  * scanner.l: Allow a 12 digit hex number as ether address as well as 
+    BB.BB.BB.BB.BB.BB (closes: #48735)
+  * nametoaddr.c (pcap_ether_aton): Adjust for change in scanner.l
+
+ -- Torsten Landschoff <torsten@debian.org>  Mon, 22 Nov 1999 02:39:45 +0100
+
+libpcap (0.4a6-2.1) unstable; urgency=low
+
+  * Non maintainer upload.
+    config.{guess,sub} changed to recognize a Arm architecture.
+
+ -- Turbo Fredriksson <turbo@debian.org>  Thu, 20 Aug 1998 23:12:36 -0400
+
+libpcap (0.4a6-2) frozen unstable; urgency=low
+
+  * renamed /usr/doc/libpcap to /usr/doc/libpcap0 (should fix several
+    lintian warnings)
+  * updated standards-version
+  * rebuild with latest debmake
+
+ -- Peter Tobias <tobias@et-inf.fho-emden.de>  Mon, 30 Mar 1998 00:46:44 +0200
+
+
+libpcap (0.4a6-1) unstable; urgency=low
+
+  * upgraded to latest upstream version, fixes: Bug#17164
+  * added patch from Michael Alan Dorman <mdorman@mdorman.law.miami.edu>
+    for building libpcap on alpha systems, fixes: Bug#15556
+  * fixed aclocal.m4 script
+
+ -- Peter Tobias <tobias@et-inf.fho-emden.de>  Sat, 31 Jan 1998 23:19:42 +0100
+
+
+libpcap (0.4a2-2) unstable; urgency=low
+
+  * fixed detection of IFF_LOOPBACK for linux systems
+  * link shared library with -l
+
+ -- Peter Tobias <tobias@et-inf.fho-emden.de>  Wed, 19 Nov 1997 23:44:34 +0100
+
+
+libpcap (0.4a2-1) unstable; urgency=low
+
+  * new maintainer
+  * latest upstream release
+  * libc6 version
+  * compiled with _REENTRANT
+
+ -- Peter Tobias <tobias@et-inf.fho-emden.de>  Wed, 17 Sep 1997 20:40:01 +0200
+
+
+libpcap (0.3.1a3-1) unstable; urgency=low
+
+  * Latest upstream release.  Fixes bug #6670.
+
+ -- Karl Sackett <krs@debian.org>  Wed, 2 Apr 1997 10:19:28 -0600
+
+
+libpcap (0.3-1) unstable; urgency=low
+
+  * First Debian release.
+  * Makefile.in: supports libpcap.so target.
+
+ -- Karl Sackett <krs@debian.org>  Wed, 8 Jan 1997 09:38:31 -0600
+
+
--- libpcap0.8-0.8.3.orig/debian/rules
+++ libpcap0.8-0.8.3/debian/rules
@@ -0,0 +1,81 @@
+#!/usr/bin/make -f
+
+include /usr/share/dpatch/dpatch.make
+
+version := $(shell head -1 debian/changelog | \
+	perl -nle 'm/\S+\s+\((\S+)-\S+\)/ and print $$1')
+major := $(shell head -1 debian/changelog | perl -nle \
+	'm/\S+\s+\((\d\.\d)\.\d+-\S+\)/ and print $$1')
+
+export CFLAGS=-D_FILE_OFFSET_BITS=64
+
+ifneq (,$(findstring noopt,$(DEB_BUILD_OPTIONS)))
+        CFLAGS += -O0
+endif
+
+build: patch build-stamp
+build-stamp:
+	dh_testdir
+
+	./configure --prefix=/usr \
+		--mandir=\$${prefix}/share/man \
+		--enable-ipv6 --infodir=\$${prefix}/share/info
+	$(MAKE)
+
+	touch build-stamp
+
+clean: clean-patched unpatch
+clean-patched:
+	dh_testdir
+	dh_testroot
+	rm -f build-stamp
+
+	-$(MAKE) distclean
+
+	rm -f net
+
+	dh_clean
+
+install: build
+	dh_testdir
+	dh_testroot
+	dh_clean -k
+	dh_installdirs
+
+	$(MAKE) install prefix=`pwd`/debian/libpcap0.8-dev/usr
+
+binary-indep: build install
+# We have nothing to do by default.
+
+binary-arch: build install
+#	dh_testversion
+	dh_testdir
+	dh_testroot
+        #
+        # build libpcap${major} package by moving files from libpcap0.8-dev
+        #
+	dh_movefiles -plibpcap$(major) --sourcedir=debian/libpcap0.8-dev \
+		usr/lib/libpcap.so.$(major)        \
+		usr/lib/libpcap.so.$(version)
+
+#	dh_installdebconf	
+	dh_installdocs -A debian/README.Debian
+	dh_installexamples
+	dh_installmenu
+	dh_installmanpages -plibpcap0.8-dev
+	dh_installinfo
+#	dh_undocumented
+	dh_installchangelogs CHANGES
+	dh_link -plibpcap0.8-dev
+	dh_strip
+	dh_compress
+	dh_fixperms
+	dh_makeshlibs
+	dh_installdeb
+	dh_shlibdeps 
+	dh_gencontrol
+	dh_md5sums
+	dh_builddeb
+
+binary: binary-indep binary-arch
+.PHONY: build clean binary-indep binary-arch binary install
--- libpcap0.8-0.8.3.orig/debian/patches/10_shared_lib.dpatch
+++ libpcap0.8-0.8.3/debian/patches/10_shared_lib.dpatch
@@ -0,0 +1,144 @@
+#! /bin/sh -e
+## 10_shared_lib.dpatch by Romain Francoise <rfrancoise@debian.org>
+##
+## All lines beginning with `## DP:' are a description of the patch.
+## DP: Debian-specific modifications to the upstream Makefile.in to
+## DP: build a shared library.
+
+if [ $# -lt 1 ]; then
+    echo "`basename $0`: script expects -patch|-unpatch as argument" >&2
+    exit 1
+fi
+
+[ -f debian/patches/00patch-opts ] && . debian/patches/00patch-opts
+patch_opts="${patch_opts:--f --no-backup-if-mismatch} ${2:+-d $2}"
+
+case "$1" in
+    -patch) patch -p1 ${patch_opts} < $0;;
+    -unpatch) patch -R -p1 ${patch_opts} < $0;;
+    *)
+        echo "`basename $0`: script expects -patch|-unpatch as argument" >&2
+        exit 1;;
+esac
+
+exit 0
+
+@DPATCH@
+diff -urNad /home/romain/Work/Debian/libpcap/libpcap0.8/libpcap0.8-0.8.3/Makefile.in libpcap0.8-0.8.3/Makefile.in
+--- /home/romain/Work/Debian/libpcap/libpcap0.8/libpcap0.8-0.8.3/Makefile.in	2004-04-30 16:40:33.000000000 +0200
++++ libpcap0.8-0.8.3/Makefile.in	2004-04-30 16:41:43.000000000 +0200
+@@ -37,6 +37,15 @@
+ srcdir = @srcdir@
+ VPATH = @srcdir@
+ 
++# some defines for shared library compilation
++MAJ=$(shell head -1 debian/changelog | perl -nle 'm/\S+\s+\((\d\.\d)\.\d+-\S+\)/ and print $$1')
++MIN=$(shell head -1 debian/changelog | perl -nle 'm/\S+\s+\(\d\.\d\.(\d+)-\S+\)/ and print $$1')
++VERSION=$(MAJ).$(MIN)
++LIBNAME=pcap
++LIBRARY=lib$(LIBNAME).a
++SOLIBRARY=lib$(LIBNAME).so
++SHAREDLIB=$(SOLIBRARY).$(VERSION)
++
+ #
+ # You shouldn't need to edit anything below.
+ #
+@@ -49,6 +58,7 @@
+ 
+ # Standard CFLAGS
+ CFLAGS = $(CCOPT) $(INCLS) $(DEFS)
++CFLAGS_SHARED = -shared -Wl,-soname,$(SOLIBRARY).$(MAJ)
+ 
+ INSTALL = @INSTALL@
+ INSTALL_PROGRAM = @INSTALL_PROGRAM@
+@@ -68,7 +78,11 @@
+ # problem if you don't own the file but can write to the directory.
+ .c.o:
+ 	@rm -f $@
+-	$(CC) $(CFLAGS) -c $(srcdir)/$*.c
++	$(CC) $(CFLAGS) -c -o $@ $(srcdir)/$*.c
++
++%_pic.o: %.c
++	@rm -f $@
++	$(CC) -fPIC $(CFLAGS) -c -o $@ $(srcdir)/$*.c
+ 
+ PSRC =	pcap-@V_PCAP@.c
+ FSRC =  fad-@V_FINDALLDEVS@.c
+@@ -83,6 +97,7 @@
+ # We would like to say "OBJ = $(SRC:.c=.o)" but Ultrix's make cannot
+ # hack the extra indirection
+ OBJ =	$(PSRC:.c=.o) $(FSRC:.c=.o) $(CSRC:.c=.o) $(SSRC:.c=.o) $(GENSRC:.c=.o) $(LIBOBJS)
++OBJ_PIC = $(PSRC:.c=_pic.o) $(FSRC:.c=_pic.o) $(CSRC:.c=_pic.o) $(SSRC:.c=_pic.o) $(GENSRC:.c=_pic.o)
+ HDR =	pcap.h pcap-int.h pcap-namedb.h pcap-nit.h pcap-pf.h \
+ 	ethertype.h gencode.h gnuc.h
+ GENHDR = \
+@@ -94,15 +109,22 @@
+ TAGFILES = \
+ 	$(SRC) $(HDR) $(TAGHDR)
+ 
+-CLEANFILES = $(OBJ) libpcap.a $(GENSRC) $(GENHDR) lex.yy.c
++CLEANFILES = $(OBJ) $(OBJ_PIC) libpcap.a $(GENSRC) $(GENHDR) lex.yy.c libpcap.so*
+ 
+-all: libpcap.a
++all: libpcap.a $(SHAREDLIB)
+ 
+ libpcap.a: $(OBJ)
+ 	@rm -f $@
+ 	ar rc $@ $(OBJ) $(LIBS)
+ 	$(RANLIB) $@
+ 
++$(SHAREDLIB): $(OBJ_PIC)
++	-@rm -f $@
++	-@rm -f $(SOLIBRARY) $(SOLIBRARY).$(MAJ)
++	$(CC) $(CFLAGS_SHARED) -o $(SHAREDLIB) $(OBJ_PIC) -lc
++	ln -s $(SHAREDLIB) $(SOLIBRARY).$(MAJ)
++	ln -s $(SOLIBRARY).$(MAJ) $(SOLIBRARY)
++
+ scanner.c: $(srcdir)/scanner.l
+ 	@rm -f $@
+ 	$(LEX) -t $< > $$$$.$@; mv $$$$.$@ $@
+@@ -110,6 +132,9 @@
+ scanner.o: scanner.c tokdefs.h
+ 	$(CC) $(CFLAGS) -c scanner.c
+ 
++scanner_pic.o: scanner.c tokdefs.h
++	$(CC) -fPIC $(CFLAGS) -o $@ -c scanner.c
++
+ pcap.o: version.h
+ 
+ tokdefs.h: grammar.c
+@@ -123,9 +148,17 @@
+ 	@rm -f $@
+ 	$(CC) $(CFLAGS) -Dyylval=pcap_lval -c grammar.c
+ 
++grammar_pic.o: grammar.c
++	@rm -f $@
++	$(CC) -fPIC $(CFLAGS) -Dyylval=pcap_lval -o $@ -c grammar.c 
++
+ version.o: version.c
+ 	$(CC) $(CFLAGS) -c version.c
+ 
++version_pic.o: version.c
++	$(CC) -fPIC $(CFLAGS) -c version.c -o $@
++
++
+ snprintf.o: $(srcdir)/missing/snprintf.c
+ 	$(CC) $(CFLAGS) -o $@ -c $(srcdir)/missing/snprintf.c
+ 
+@@ -151,10 +184,16 @@
+ bpf_filter.o: bpf_filter.c
+ 	$(CC) $(CFLAGS) -c bpf_filter.c
+ 
++bpf_filter_pic.o: bpf_filter.c
++	$(CC) -fPIC $(CFLAGS) -c bpf_filter.c -o $@
++
+ install:
+ 	[ -d $(DESTDIR)$(libdir) ] || \
+ 	    (mkdir -p $(DESTDIR)$(libdir); chmod 755 $(DESTDIR)$(libdir))
+ 	$(INSTALL_DATA) libpcap.a $(DESTDIR)$(libdir)/libpcap.a
++	$(INSTALL_DATA) $(SHAREDLIB) $(DESTDIR)$(libdir)/
++	ln -sf $(SHAREDLIB) $(DESTDIR)$(libdir)/$(SOLIBRARY).$(MAJ)
++	ln -sf $(SOLIBRARY).$(MAJ) $(DESTDIR)$(libdir)/$(SOLIBRARY)
+ 	$(RANLIB) $(DESTDIR)$(libdir)/libpcap.a
+ 	[ -d $(DESTDIR)$(includedir) ] || \
+ 	    (mkdir -p $(DESTDIR)$(includedir); chmod 755 $(DESTDIR)$(includedir))
--- libpcap0.8-0.8.3.orig/debian/patches/20_mac_syntax.dpatch
+++ libpcap0.8-0.8.3/debian/patches/20_mac_syntax.dpatch
@@ -0,0 +1,68 @@
+#! /bin/sh -e
+## 20_mac_syntax.dpatch by Torsten Landschoff <torsten@debian.org>
+##
+## All lines beginning with `## DP:' are a description of the patch.
+## DP: Adds more possible syntaxes to input MAC addresses:
+## DP: - the nn.nn.nn.nn.nn.nn syntax
+## DP: - the hexadecimal syntax
+
+if [ $# -lt 1 ]; then
+    echo "`basename $0`: script expects -patch|-unpatch as argument" >&2
+    exit 1
+fi
+
+[ -f debian/patches/00patch-opts ] && . debian/patches/00patch-opts
+patch_opts="${patch_opts:--f --no-backup-if-mismatch} ${2:+-d $2}"
+
+case "$1" in
+    -patch) patch -p1 ${patch_opts} < $0;;
+    -unpatch) patch -R -p1 ${patch_opts} < $0;;
+    *)
+        echo "`basename $0`: script expects -patch|-unpatch as argument" >&2
+        exit 1;;
+esac
+
+exit 0
+
+@DPATCH@
+diff -urNad /home/romain/Work/Debian/libpcap/libpcap0.8/libpcap0.8-0.8.3/nametoaddr.c libpcap0.8-0.8.3/nametoaddr.c
+--- /home/romain/Work/Debian/libpcap/libpcap0.8/libpcap0.8-0.8.3/nametoaddr.c	2004-04-30 15:45:14.000000000 +0200
++++ libpcap0.8-0.8.3/nametoaddr.c	2004-04-30 15:57:54.000000000 +0200
+@@ -333,7 +333,7 @@
+ 	e = ep = (u_char *)malloc(6);
+ 
+ 	while (*s) {
+-		if (*s == ':')
++		if (*s == ':' || *s == '.')
+ 			s += 1;
+ 		d = xdtoi(*s++);
+ 		if (isxdigit((unsigned char)*s)) {
+diff -urNad /home/romain/Work/Debian/libpcap/libpcap0.8/libpcap0.8-0.8.3/scanner.l libpcap0.8-0.8.3/scanner.l
+--- /home/romain/Work/Debian/libpcap/libpcap0.8/libpcap0.8-0.8.3/scanner.l	2004-04-30 15:45:14.000000000 +0200
++++ libpcap0.8-0.8.3/scanner.l	2004-04-30 15:57:54.000000000 +0200
+@@ -80,6 +80,7 @@
+ N		([0-9]+|(0X|0x)[0-9A-Fa-f]+)
+ B		([0-9A-Fa-f][0-9A-Fa-f]?)
+ W		([0-9A-Fa-f][0-9A-Fa-f]?[0-9A-Fa-f]?[0-9A-Fa-f]?)
++X		[0-9A-Fa-f]
+ 
+ %a 16000
+ %o 19000
+@@ -296,7 +297,7 @@
+ {N}			{ yylval.i = stoi((char *)yytext); return NUM; }
+ ({N}\.{N})|({N}\.{N}\.{N})|({N}\.{N}\.{N}\.{N})	{
+ 			yylval.s = sdup((char *)yytext); return HID; }
+-{B}:{B}:{B}:{B}:{B}:{B} { yylval.e = pcap_ether_aton((char *)yytext);
++({B}:{B}:{B}:{B}:{B}:{B})|({B}\.{B}\.{B}\.{B}\.{B}\.{B}) { yylval.e = pcap_ether_aton((char *)yytext);
+ 			  return EID; }
+ {V6}			{
+ #ifdef INET6
+@@ -314,6 +315,8 @@
+ #endif /*INET6*/
+ 			}
+ {B}:+({B}:+)+		{ bpf_error("bogus ethernet address %s", yytext); }
++{X}{12}			{ yylval.e = pcap_ether_aton((char *)yytext); return EID;}
++
+ icmptype		{ yylval.i = 0; return NUM; }
+ icmpcode		{ yylval.i = 1; return NUM; }
+ icmp-echoreply		{ yylval.i = 0; return NUM; }
--- libpcap0.8-0.8.3.orig/debian/patches/00list
+++ libpcap0.8-0.8.3/debian/patches/00list
@@ -0,0 +1,3 @@
+10_shared_lib
+20_mac_syntax
+30_man_fixes
--- libpcap0.8-0.8.3.orig/debian/patches/30_man_fixes.dpatch
+++ libpcap0.8-0.8.3/debian/patches/30_man_fixes.dpatch
@@ -0,0 +1,57 @@
+#! /bin/sh -e
+## 30_man_fixes.dpatch by Romain Francoise <rfrancoise@debian.org>
+##
+## All lines beginning with `## DP:' are a description of the patch.
+## DP: Misc. fixes to the upstream man page.
+
+if [ $# -lt 1 ]; then
+    echo "`basename $0`: script expects -patch|-unpatch as argument" >&2
+    exit 1
+fi
+
+[ -f debian/patches/00patch-opts ] && . debian/patches/00patch-opts
+patch_opts="${patch_opts:--f --no-backup-if-mismatch} ${2:+-d $2}"
+
+case "$1" in
+    -patch) patch -p1 ${patch_opts} < $0;;
+    -unpatch) patch -R -p1 ${patch_opts} < $0;;
+    *)
+        echo "`basename $0`: script expects -patch|-unpatch as argument" >&2
+        exit 1;;
+esac
+
+exit 0
+
+@DPATCH@
+diff -urNad /home/romain/Work/Debian/libpcap0.8/libpcap0.8-0.8.3/pcap.3 libpcap0.8-0.8.3/pcap.3
+--- /home/romain/Work/Debian/libpcap0.8/libpcap0.8-0.8.3/pcap.3	2004-07-21 19:41:53.000000000 +0200
++++ libpcap0.8-0.8.3/pcap.3	2004-07-21 19:42:28.000000000 +0200
+@@ -201,7 +201,7 @@
+ .I fname
+ specifies the name of the file to open. The file has
+ the same format as those used by
+-.B tcpdump(1)
++.B tcpdump(8)
+ and
+ .BR tcpslice(1) .
+ The name "-" in a synonym for
+@@ -404,7 +404,9 @@
+ live capture, or all the packets in the file when reading a
+ ``savefile''.
+ .I callback
+-specifies a routine to be called with three arguments:
++specifies a 
++.I pcap_handler
++routine to be called with three arguments:
+ a
+ .I u_char
+ pointer which is passed in from
+@@ -1168,7 +1170,7 @@
+ closes the ``savefile.''
+ .PP
+ .SH SEE ALSO
+-tcpdump(1), tcpslice(1)
++tcpdump(8), tcpslice(1)
+ .SH AUTHORS
+ The original authors are:
+ .LP
--- libpcap0.8-0.8.3.orig/debian/README.Debian
+++ libpcap0.8-0.8.3/debian/README.Debian
@@ -0,0 +1,13 @@
+libpcap for Debian
+------------------
+
+ If you receive messages telling you the packet type is not supported
+ or is deprecated check that CONFIG_PACKET is set to either `Y' or `M'.
+
+ You should also check that /etc/modules.conf has the line
+
+	alias net-pf-17 af_packet
+
+ Feel free to report bugs.
+
+ -- Anand Kumria <wildfire@progsoc.org>, Tue, 28 Nov 2000 02:04:28 EST
--- libpcap0.8-0.8.3.orig/debian/libpcap0.8-dev.preinst
+++ libpcap0.8-0.8.3/debian/libpcap0.8-dev.preinst
@@ -0,0 +1,9 @@
+#!/bin/sh
+set -e
+
+# Remove old symlink, if it exists
+if [ -L /usr/share/doc/libpcap-dev ]; then 
+	rm -f /usr/share/doc/libpcap-dev ; 
+fi
+
+#DEBHELPER#
--- libpcap0.8-0.8.3.orig/debian/libpcap0.8.postinst
+++ libpcap0.8-0.8.3/debian/libpcap0.8.postinst
@@ -0,0 +1,8 @@
+#! /bin/sh
+
+if [ "$1" = "configure" ]; then
+	ldconfig
+fi
+
+#DEBHELPER#
+
--- libpcap0.8-0.8.3.orig/debian/libpcap0.8-dev.dirs
+++ libpcap0.8-0.8.3/debian/libpcap0.8-dev.dirs
@@ -0,0 +1,3 @@
+usr/lib
+usr/include
+usr/share/man/man3
--- libpcap0.8-0.8.3.orig/debian/libpcap0.8.docs
+++ libpcap0.8-0.8.3/debian/libpcap0.8.docs
@@ -0,0 +1,2 @@
+README
+CREDITS
--- libpcap0.8-0.8.3.orig/debian/libpcap0.8.postrm
+++ libpcap0.8-0.8.3/debian/libpcap0.8.postrm
@@ -0,0 +1,8 @@
+#! /bin/sh
+
+if [ "$1" = "remove" ]; then
+	ldconfig
+fi
+
+#DEBHELPER#
+
